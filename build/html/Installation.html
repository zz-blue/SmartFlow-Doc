<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; SmartFlow  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Run a case" href="Run_a_case.html" />
    <link rel="prev" title="How it works" href="How_it_works.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SmartFlow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="How_it_works.html">How it works</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">1. SmartSim and SmartRedis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stablebaselines3">2. Stable-Baselines3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#smartflow">3. SmartFlow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#smartredismpi">4. SmartRedis-MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cfd-solver">5. CFD Solver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Run_a_case.html">Run a case</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SmartFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h1>
<p>The following components are required to use the SmartFlow framework:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#id1"><span class="std std-ref">SmartSim and SmartRedis</span></a></p></li>
<li><p><a class="reference internal" href="#stablebaselines3"><span class="std std-ref">Stable-Baselines3</span></a></p></li>
<li><p><a class="reference internal" href="#smartflow"><span class="std std-ref">SmartFlow</span></a></p></li>
<li><p><a class="reference internal" href="#smartredismpi"><span class="std std-ref">SmartRedis-MPI</span></a></p></li>
<li><p><a class="reference internal" href="#cfd-solver"><span class="std std-ref">CFD Solver</span></a></p></li>
</ol>
<p>For comprehensive installation instructions, please refer to the official documentation for each component:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.craylabs.org/docs/installation_instructions/basic.html">SmartSim and SmartRedis</a></p></li>
<li><p><a class="reference external" href="https://github.com/soaringxmc/smartredis-mpi">SmartRedis-MPI</a></p></li>
<li><p><a class="reference external" href="https://stable-baselines3.readthedocs.io/en/master/guide/install.html">Stable-Baselines3</a></p></li>
</ul>
<p>If you plan to contribute advanced features to the framework, we recommend thoroughly reviewing both the
<a class="reference external" href="https://www.craylabs.org/docs/overview.html">SmartSim Documentation</a> and
<a class="reference external" href="https://stable-baselines3.readthedocs.io/en/master/">Stable-Baselines3 Documentation</a> documentation.</p>
<p>Below is a quick installation guide for all components. Note that Python 3.9–3.11 is required for compatibility.
We recommend starting with a fresh virtual environment if your system has already installed Python packages.:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>/path/to/smartflow/environment
<span class="nb">source</span><span class="w"> </span>/path/to/smartflow/environment/bin/activate
</pre></div>
</div>
<p>Also you can use anaconda to create and manage your virtual environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new conda environment named &quot;smartflow&quot; with Python 3.10</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>smartflow<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.10
conda<span class="w"> </span>activate<span class="w"> </span>smartflow
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SmartFlow fully supports <strong>OpenMPI</strong> by default. Using other MPI implementations may require extra setup or tuning.</p>
</div>
<section id="id1">
<span id="id2"></span><h2>1. SmartSim and SmartRedis<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<p>SmartSim provides the infrastructure for launching and managing simulations, while SmartRedis provides client
interfaces for interacting with the in-memory Redis database.</p>
<p><strong>Python Installation</strong></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install SmartSim</span>
pip<span class="w"> </span>install<span class="w"> </span>smartsim
<span class="c1"># Build SmartSim with CPU support and Dragon</span>
smart<span class="w"> </span>build<span class="w"> </span>--device<span class="w"> </span>cpu<span class="w"> </span>--dragon

<span class="c1"># Install SmartRedis Python client</span>
pip<span class="w"> </span>install<span class="w"> </span>smartredis
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--dragon</span></code> option is not required essentially. The following command also works:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>smart<span class="w"> </span>build<span class="w"> </span>--device<span class="w"> </span>cpu
</pre></div>
</div>
</div>
<p><strong>C, C++, and Fortran Client Libraries</strong></p>
<p>For compiled language applications, the SmartRedis client libraries need to be built from source.
We currently use version 0.5.3 for compatibility.</p>
<p><strong>Using GCC Compilers</strong></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/CrayLabs/SmartRedis<span class="w"> </span>--depth<span class="o">=</span><span class="m">1</span><span class="w"> </span>--branch<span class="o">=</span>v0.5.3<span class="w"> </span>smartredis
<span class="nb">cd</span><span class="w"> </span>smartredis
make<span class="w"> </span>lib-with-fortran<span class="w"> </span><span class="nv">CC</span><span class="o">=</span>gcc<span class="w"> </span><span class="nv">CXX</span><span class="o">=</span>g++<span class="w"> </span><span class="nv">FC</span><span class="o">=</span>gfortran
</pre></div>
</div>
<p>After compilation, add the library path to your environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/path/to/smartredis/lib
<span class="c1"># Add this to your .bashrc or .bash_profile for persistence</span>
</pre></div>
</div>
<p><strong>Using NVIDIA Compilers (for GPU-enabled applications)</strong></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>smartredis
make<span class="w"> </span>lib-with-fortran<span class="w"> </span><span class="nv">CC</span><span class="o">=</span>nvc<span class="w"> </span><span class="nv">CXX</span><span class="o">=</span>nvc++<span class="w"> </span><span class="nv">FC</span><span class="o">=</span>nvfortran
</pre></div>
</div>
<p><strong>Installation Notes and Verification</strong></p>
<p>The CFD solver, SmartRedis, and SmartRedis-MPI <strong>must</strong> be compiled with the same compiler to ensure proper linking.</p>
<p>The command <code class="docutils literal notranslate"><span class="pre">smart</span> <span class="pre">build</span> <span class="pre">--device</span> <span class="pre">cpu</span> <span class="pre">--dragon</span></code> not only builds SmartSim with CPU and Dragon support,
but also installs and configures <code class="docutils literal notranslate"><span class="pre">RedisAI</span></code>, enabling machine learning model execution within Redis.</p>
<p>After the installation, you can verify the setup using the following command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>smart<span class="w"> </span>info
</pre></div>
</div>
<p>If the installation is successful, you should see output similar to the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Smart Python Packages:
╒════════════╤═══════════╕
│ Name       │ Version   │
╞════════════╪═══════════╡
│ SmartSim   │ 0.7.0     │
│ SmartRedis │ 0.5.3     │
╘════════════╧═══════════╛

Orchestrator Configuration:
╒═══════════╤═════════════════════════════════════════════════════════════════════════════════════╕
│ Installed │ REDIS                                                                               │
│ Location  │ /smartsod2d/lib/python3.10/site-packages/smartsim/_core/bin/redis-cli │
╘═══════════╧═════════════════════════════════════════════════════════════════════════════════════╛

Redis AI Configuration:
╒══════════╤══════════════════════════════════════════════════════════════════════════════════════╕
│ Status   │ Installed                                                                            │
│ Location │ /smartsod2d/lib/python3.10/site-packages/smartsim/_core/lib/redisai.so │
╘══════════╧══════════════════════════════════════════════════════════════════════════════════════╛

Machine Learning Backends:
╒════════════╤═════════════════════╤══════════════════╕
│ Name       │ Backend Available   │ Python Package   │
╞════════════╪═════════════════════╪══════════════════╡
│ Tensorflow │ True                │ 2.15.0           │
│ Torch      │ True                │ 2.6.0            │
│ ONNX       │ False               │ Not Installed    │
╘════════════╧═════════════════════╧══════════════════╛
</pre></div>
</div>
</section>
<section id="stablebaselines3">
<span id="id3"></span><h2>2. Stable-Baselines3<a class="headerlink" href="#stablebaselines3" title="Permalink to this heading"></a></h2>
<p>Stable-Baselines3 is a Python library that provides implementations of reinforcement learning algorithms.
It can be installed with the following command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>stable-baselines3<span class="o">[</span>extra<span class="o">]</span>
</pre></div>
</div>
</section>
<section id="smartflow">
<span id="id4"></span><h2>3. SmartFlow<a class="headerlink" href="#smartflow" title="Permalink to this heading"></a></h2>
<p>We recommand to use <a class="reference external" href="https://github.com/soaringxmc/SmartFlow/releases/tag/v1.0.1">SmartFlow-v1.0.1</a> as a stable version.</p>
<p>To install SmartFlow, clone the repository and install the required packages:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Directory where you want to clone the repository</span>
<span class="nb">cd</span><span class="w"> </span>/your/local/dir/code
<span class="c1"># Clone the SmartFlow repository</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/soaringxmc/SmartFlow.git<span class="w"> </span>--branch<span class="o">=</span>v1.0.1
</pre></div>
</div>
<p>SmartFlow is installed with the following commands:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>SmartFlow
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<p>This will mark the current package as editable, so it can be modified and the changes will be automatically
available to the Python environment.</p>
<p><strong>Scripts Installation</strong></p>
<p>The scripts in SmartFlow rely on additional Python packages that may not be listed in the default installation.
In particular, make sure the following libraries are installed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">omegaconf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wandb</span></code></p></li>
</ul>
<p>You can install them with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>omegaconf<span class="w"> </span>wandb
</pre></div>
</div>
</section>
<section id="smartredismpi">
<span id="id5"></span><h2>4. SmartRedis-MPI<a class="headerlink" href="#smartredismpi" title="Permalink to this heading"></a></h2>
<p>Before installing the CFD solver, build the SmartRedis-MPI library that will be linked by the MPI-based parallel CFD solver:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/soaringxmc/smartredis-mpi.git
<span class="nb">cd</span><span class="w"> </span>smartredis-mpi
</pre></div>
</div>
<p>Edit the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to set the correct settings and paths to your SmartRedis installation:
The <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> is located in the folder of the <code class="docutils literal notranslate"><span class="pre">smartredis-mpi</span></code> repository</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>vim<span class="w"> </span>Makefile
<span class="c1"># Adjust the paths in the Makefile</span>
<span class="c1"># in line 2 set the compiler</span>
<span class="nv">COMPILER</span><span class="w"> </span><span class="o">=</span>GNU

<span class="c1"># In line 4 set set the precision</span>
<span class="nv">SINGLE_PRECISION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>

<span class="c1"># In line 6 set the smartredis installation path, it should be the same as the one you set in the SmartRedis installation (step 1) or the one you set in the SmartRedis-MPI installation (step 4)</span>
SMARTREDIS<span class="w"> </span>INSTALL<span class="w"> </span><span class="nv">DIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/your/local/dir/code/smartredis/instal1
</pre></div>
</div>
<p>Add the library path to your environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/path/to/smartredis-mpi/lib
<span class="c1"># Add this to your .bashrc or .bash_profile for persistence</span>
</pre></div>
</div>
</section>
<section id="cfd-solver">
<span id="id6"></span><h2>5. CFD Solver<a class="headerlink" href="#cfd-solver" title="Permalink to this heading"></a></h2>
<p>The advantage of SmartFlow is that it can be easily integrated with any CFD solver. Only several lines of code
need to be added to the CFD solver to enable communication with the SmartFlow framework.</p>
<p>As an example, we only added five lines of code to the <a class="reference external" href="https://github.com/CaNS-World/CaLES">CaLES</a> solver
to enable its coupling with the SmartFlow framework.</p>
<p>To use SmartFlow v1.0.1 with CaLES, please ensure you are using the compatible version: <a class="reference external" href="https://github.com/CaNS-World/CaLES/releases/tag/v2.0.0-smartflow">CaLES-v2.0.0-smartflow</a></p>
<p>If you want to use CaLES as your CFD solver or simply test the workflow of the SmartFlow framework,
please refer to the <a class="reference external" href="https://github.com/CaNS-World/CaLES">CaLES</a> for installation instructions.</p>
<p><strong>Compilation Options</strong></p>
<ul class="simple">
<li><p><strong>Branch Selection</strong>: Make sure to use the <code class="docutils literal notranslate"><span class="pre">smartflow</span> <span class="pre">branch</span></code>, not the main branch.</p></li>
<li><p><strong>Build Configuration</strong>: Ensure that the parameter <code class="docutils literal notranslate"><span class="pre">PENCIL_AXIS</span></code> is set to <strong>3</strong> in the <code class="docutils literal notranslate"><span class="pre">build.conf</span></code> file.</p></li>
</ul>
<p>We suggest presenting the CFD solvers coupled to SmartFlow in the following table:</p>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">CFD Solvers Coupled with SmartFlow</span><a class="headerlink" href="#id8" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Solver</p></th>
<th class="head"><p>Coupling Status</p></th>
<th class="head"><p>Device Support</p></th>
<th class="head"><p>Numerical Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CaLES</p></td>
<td><p>Coupled</p></td>
<td><p>CPU/GPU</p></td>
<td><p>Finite Difference</p></td>
</tr>
<tr class="row-odd"><td><p>SOD2D</p></td>
<td><p>Coupled</p></td>
<td><p>CPU/GPU</p></td>
<td><p>Spectral Element</p></td>
</tr>
<tr class="row-even"><td><p>FLEXI</p></td>
<td><p>In progress</p></td>
<td><p>CPU</p></td>
<td><p>Discontinuous Galerkin</p></td>
</tr>
<tr class="row-odd"><td><p>HORSES3D</p></td>
<td><p>In progress</p></td>
<td><p>CPU</p></td>
<td><p>Discontinuous Galerkin</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="How_it_works.html" class="btn btn-neutral float-left" title="How it works" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Run_a_case.html" class="btn btn-neutral float-right" title="Run a case" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, SmartFlow contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>